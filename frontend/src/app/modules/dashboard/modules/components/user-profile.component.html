<div class="container-fluid">
  <div class="row">
    <div class="col-12">
      <!-- Breadcrumb -->
      <div class="page-title-box">
        <div class="page-title-right">
          <ol class="breadcrumb m-0">
            <li class="breadcrumb-item"><a routerLink="/dashboard">Home</a></li>
            <li class="breadcrumb-item active">Mon Profil</li>
          </ol>
        </div>
        <h4 class="page-title">Mon Profil</h4>
      </div>
    </div>
  </div>

  <div class="row">
    <!-- Profile Card -->
    <div class="col-xl-4 col-lg-5">
      <div class="card text-center">
        <div class="card-body">
          <div class="mb-3">
            <img 
              [src]="avatarPreview || 'assets/images/user/avatar-1.jpg'" 
              class="rounded-circle avatar-lg img-thumbnail" 
              alt="profile-image"
              (click)="fileInput.click()"
              style="cursor: pointer; width: 120px; height: 120px; object-fit: cover;"
            />
            <input 
              #fileInput 
              type="file" 
              accept="image/*" 
              (change)="uploadAvatar($event)" 
              style="display: none;"
            />
            <div class="mt-2">
              <button class="btn btn-sm btn-outline-primary" (click)="fileInput.click()">
                <i class="ph-duotone ph-camera"></i> Changer l'avatar
              </button>
            </div>
          </div>

          <h4 class="mb-1">{{ profile?.firstName || 'Prénom' }} {{ profile?.lastName || 'Nom' }}</h4>
          <p class="text-muted">{{ profile?.email || 'email@example.com' }}</p>
          
          <div class="text-start mt-3">
            <h4 class="font-13 text-uppercase">À propos :</h4>
            <p class="text-muted font-13 mb-3">
              {{ profile?.company || 'Aucune entreprise renseignée' }}
            </p>
            
            <p class="text-muted mb-2 font-13">
              <strong>Téléphone :</strong> 
              <span class="ms-2">{{ profile?.phone || 'Non renseigné' }}</span>
            </p>
            
            <p class="text-muted mb-2 font-13">
              <strong>Rôle :</strong> 
              <span class="ms-2 badge bg-primary">{{ profile?.role || 'Utilisateur' }}</span>
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Details -->
    <div class="col-xl-8 col-lg-7">
      <div class="card">
        <div class="card-body">
          <ul class="nav nav-tabs nav-bordered">
            <li class="nav-item">
              <a href="#profile-b1" data-bs-toggle="tab" aria-expanded="false" class="nav-link active">
                <i class="ph-duotone ph-user me-1"></i>Informations personnelles
              </a>
            </li>
            <li class="nav-item">
              <a href="#profile-b2" data-bs-toggle="tab" aria-expanded="true" class="nav-link">
                <i class="ph-duotone ph-lock-key me-1"></i>Changer le mot de passe
              </a>
            </li>
          </ul>
          <div class="tab-content">
            <!-- Personal Info -->
            <div class="tab-pane show active" id="profile-b1">
              <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="firstName" class="form-label">Prénom</label>
                      <input 
                        type="text" 
                        class="form-control" 
                        id="firstName" 
                        formControlName="firstName"
                        placeholder="Votre prénom"
                      >
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="lastName" class="form-label">Nom</label>
                      <input 
                        type="text" 
                        class="form-control" 
                        id="lastName" 
                        formControlName="lastName"
                        placeholder="Votre nom"
                      >
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="email" class="form-label">Email</label>
                      <input 
                        type="email" 
                        class="form-control" 
                        id="email" 
                        formControlName="email"
                        placeholder="votre@email.com"
                        readonly
                      >
                      <small class="text-muted">L'email ne peut pas être modifié</small>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="phone" class="form-label">Téléphone</label>
                      <input 
                        type="tel" 
                        class="form-control" 
                        id="phone" 
                        formControlName="phone"
                        placeholder="Votre numéro de téléphone"
                      >
                    </div>
                  </div>
                </div>

                <div class="mb-3">
                  <label for="company" class="form-label">Entreprise</label>
                  <input 
                    type="text" 
                    class="form-control" 
                    id="company" 
                    formControlName="company"
                    placeholder="Nom de votre entreprise"
                  >
                </div>

                <div class="text-end">
                  <button 
                    type="submit" 
                    class="btn btn-primary" 
                    [disabled]="profileForm.invalid || isSaving"
                  >
                    <span *ngIf="isSaving" class="spinner-border spinner-border-sm me-1"></span>
                    {{ isSaving ? 'Sauvegarde...' : 'Sauvegarder les modifications' }}
                  </button>
                </div>
              </form>
            </div>

            <!-- Change Password -->
            <div class="tab-pane" id="profile-b2">
              <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
                <div class="mb-3">
                  <label for="currentPassword" class="form-label">Mot de passe actuel</label>
                  <input 
                    type="password" 
                    class="form-control" 
                    id="currentPassword" 
                    formControlName="currentPassword"
                    placeholder="Votre mot de passe actuel"
                  >
                </div>

                <div class="row">
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="newPassword" class="form-label">Nouveau mot de passe</label>
                      <input 
                        type="password" 
                        class="form-control" 
                        id="newPassword" 
                        formControlName="newPassword"
                        placeholder="Nouveau mot de passe"
                      >
                      <small class="text-muted">Minimum 8 caractères</small>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="mb-3">
                      <label for="confirmPassword" class="form-label">Confirmer le mot de passe</label>
                      <input 
                        type="password" 
                        class="form-control" 
                        id="confirmPassword" 
                        formControlName="confirmPassword"
                        placeholder="Confirmer le nouveau mot de passe"
                      >
                    </div>
                  </div>
                </div>

                <div class="text-end">
                  <button 
                    type="submit" 
                    class="btn btn-warning" 
                    [disabled]="passwordForm.invalid || isChangingPassword"
                  >
                    <span *ngIf="isChangingPassword" class="spinner-border spinner-border-sm me-1"></span>
                    {{ isChangingPassword ? 'Modification...' : 'Changer le mot de passe' }}
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


